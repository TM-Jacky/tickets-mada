<?php
// Traitement de la connexion
if ($_SERVER['REQUEST_METHOD'] == 'POST') {
    $email = $_POST['email'];
    $password = $_POST['pass'];

    // Lire le fichier users.txt
    $file = 'users.txt';
    $lines = file($file);

    // Vérifier chaque utilisateur
    foreach ($lines as $line) {
        // Sauter l'entête
        if (strpos($line, 'Email') !== false) continue;

        list($stored_email, $stored_password, $firstname, $lastname) = explode(';', trim($line));

        if ($email == $stored_email && password_verify($password, $stored_password)) {
            // Connexion réussie, redirection vers le dashboard
            header("Location: dashboard_test.html?firstname=$firstname&lastname=$lastname");
            exit();
        }
    }

    // Connexion échouée
    echo "Email ou mot de passe incorrect.";
}
?>